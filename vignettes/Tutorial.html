<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>mmetrics</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">mmetrics</h1>



<p>The <code>mmetrics</code> package contains functions necessary to
assess classification performance for statistical modelings, in
particular, when encountering multi-class classification problems or
different types of averaging methods of metric computation are of
interest. This vignette compares <code>mmetrics</code> functions to
their R equivalents in <code>caret</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(mmetrics)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(NHANES)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; randomForest 4.7-1.1</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; Type rfNews() to see new features/changes/bug fixes.</span></span></code></pre></div>
<p>There are a range of classification metric computation customization
options available for users of the package. To demonstrate this
function, the NHANES data from <code>NHANES</code> will be used.</p>
<p>In particular, we formulate our problem as building predictive
modeling based on logistic regression model. The goal is to predict
<code>Depressed</code> (categorical variable) from
<code>SleepHrsNight</code>, <code>BMI</code>,<code>Poverty</code> and
<code>PhysActive</code>, as well as demographic variable:
<code>Age</code> and <code>Gender</code>.</p>
<div id="model-fitting" class="section level2">
<h2>Model fitting</h2>
<p>First we filter out participantsâ€™ with NA value and partition the
dataset into training and testing.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># filter out records with NA value</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> NHANES[,<span class="fu">c</span>(<span class="st">&quot;Depressed&quot;</span>, <span class="st">&quot;SleepHrsNight&quot;</span>, <span class="st">&quot;BMI&quot;</span>, <span class="st">&quot;PhysActive&quot;</span>, <span class="st">&quot;Poverty&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Gender&quot;</span>)]</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="fu">apply</span>(<span class="sc">!</span><span class="fu">is.na</span>(df), <span class="dv">1</span>, all),]</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># split train and test set</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>train_id <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="fu">floor</span>(<span class="fl">0.8</span><span class="sc">*</span>n))</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>test_id <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, n)[<span class="sc">!</span>(<span class="fu">seq</span>(<span class="dv">1</span>,n) <span class="sc">%in%</span> train_id)]</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>train_df <span class="ot">&lt;-</span> df[train_id, ]</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>test_df <span class="ot">&lt;-</span> df[test_id, <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(df)]</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>target <span class="ot">&lt;-</span> df[test_id, <span class="dv">1</span>]</span></code></pre></div>
<p>Often times, we are interested in fitting more than one model and
compare their performance in hope of obtaining a more predictive model.
Hence, suppose we have two different random forest models under
different random seed for a same classification task.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Depressed<span class="sc">~</span>., train_df, <span class="at">ntree=</span><span class="dv">10</span>, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>preds_prob1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1, test_df, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>preds1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1, test_df)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Depressed<span class="sc">~</span>., train_df, <span class="at">ntree=</span><span class="dv">200</span>,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>preds_prob2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2, test_df, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>preds2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2, test_df)</span></code></pre></div>
</div>
<div id="model-performance-assessment" class="section level2">
<h2>Model performance assessment</h2>
<div id="accuracy" class="section level3">
<h3>Accuracy</h3>
<p>To calculate classification accuracy, if there is a particular class
is of interest, then <code>binary_acc</code> can be applied to calculate
class-specific accuracy scores.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>e_s1 <span class="ot">=</span> <span class="fu">binary_acc</span>(preds1<span class="sc">==</span><span class="st">&quot;Most&quot;</span>, target<span class="sc">==</span><span class="st">&quot;Most&quot;</span>); e_r1 <span class="ot">=</span> <span class="fu">binary_acc</span>(preds2<span class="sc">==</span><span class="st">&quot;Most&quot;</span>, target<span class="sc">==</span><span class="st">&quot;Most&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>e_s2 <span class="ot">=</span> <span class="fu">binary_acc</span>(preds1<span class="sc">==</span><span class="st">&quot;Most&quot;</span>, target<span class="sc">==</span><span class="st">&quot;Several&quot;</span>); e_r2 <span class="ot">=</span> <span class="fu">binary_acc</span>(preds2<span class="sc">==</span><span class="st">&quot;Most&quot;</span>, target<span class="sc">==</span><span class="st">&quot;Several&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>e_s3 <span class="ot">=</span> <span class="fu">binary_acc</span>(preds1<span class="sc">==</span><span class="st">&quot;Most&quot;</span>, target<span class="sc">==</span><span class="st">&quot;None&quot;</span>); e_r3 <span class="ot">=</span> <span class="fu">binary_acc</span>(preds2<span class="sc">==</span><span class="st">&quot;Most&quot;</span>, target<span class="sc">==</span><span class="st">&quot;None&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">model1 =</span> <span class="fu">c</span>(e_s1, e_s2, e_s3), <span class="at">model2 =</span> <span class="fu">c</span>(e_r1, e_r2, e_r3), <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;Most&quot;</span>, <span class="st">&quot;Several&quot;</span>, <span class="st">&quot;None&quot;</span>))</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt;            model1    model2</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; Most    0.9595142 0.9651822</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; Several 0.8348178 0.8291498</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; None    0.1854251 0.1829960</span></span></code></pre></div>
<p>To obtain an overall performance regarding classification accuracy,
<code>multiclass-acc</code> offers two options of averaging
classification performance across different class, where
<code>micro</code> computes global average and <code>macro</code>
computes averaged accuracies of all labels. When the ground-truth
classes of target values are imbalanced, analyst should consider using
<code>macro</code> average to mitigate bias introduced by dominant
class. Note that in multiclass accuracy calculation, one-versus-the-rest
does not apply there anymore.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">table</span>(target)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; target</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt;    None Several    Most </span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt;     983     185      67</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>mic_e_s <span class="ot">=</span> <span class="fu">multiclass_acc</span>(preds1, target)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>mac_e_s <span class="ot">=</span> <span class="fu">multiclass_acc</span>(preds1, target, <span class="at">average =</span> <span class="st">&quot;macro&quot;</span>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>mic_e_r <span class="ot">=</span> <span class="fu">multiclass_acc</span>(preds2, target)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>mac_e_r <span class="ot">=</span> <span class="fu">multiclass_acc</span>(preds2, target, <span class="at">average =</span> <span class="st">&quot;macro&quot;</span>)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">model1 =</span> <span class="fu">c</span>(mic_e_s, mac_e_s), <span class="at">model2 =</span> <span class="fu">c</span>(mic_e_r, mac_e_r), <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;Micro Average&quot;</span>, <span class="st">&quot;Macro Average&quot;</span>))</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt;                  model1    model2</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; Micro Average 0.8680162 0.8753036</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; Macro Average 0.0000000 0.0000000</span></span></code></pre></div>
</div>
<div id="confusion-scores" class="section level3">
<h3>Confusion Scores</h3>
<p>To compute the confusion matrices and corresponding scores, we can
use either <code>confusion_scores</code> to obtain binary or
class-specific result, or use <code>multiclass_confusion_scores</code>
to get the contingency table or class-specific confusion matrices.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="do">## class specific</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>mtx1 <span class="ot">=</span> <span class="fu">confusion_scores</span>(preds1<span class="sc">==</span><span class="st">&quot;Most&quot;</span>, target<span class="sc">==</span><span class="st">&quot;Most&quot;</span>)<span class="sc">$</span>matrix</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>mtx2 <span class="ot">=</span> <span class="fu">multiclass_confusion_scores</span>(preds1, target, <span class="at">classtype =</span> <span class="st">&quot;Most&quot;</span>)<span class="sc">$</span>matrix</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="fu">stopifnot</span>(mtx1<span class="sc">==</span>mtx2); mtx1</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; [1,]   21    4</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; [2,]   46 1164</span></span></code></pre></div>
<p>Or if not specify the class, <code>multiclass_confusion_scores</code>
returns a multiclass contingency table</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">multiclass_confusion_scores</span>(preds1, target)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt;          target</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; preds     None Several Most</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt;   None     967      98   40</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt;   Several   15      84    6</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;   Most       1       3   21</span></span></code></pre></div>
</div>
<div id="precision-scores" class="section level3">
<h3>Precision scores</h3>
<p>To figure out how capable the model is in their positively-predicted
cases, <code>binary_precision</code> carries out the computation in
binary classification cases. Predicted probability can also be served as
input with customizable threshold to compute precision score (the same
as accuracy score mentioned before). We demonstrate probability input to
calculate precision score in a one-versus-the-rest sense.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">binary_precision</span>(preds_prob1[,<span class="st">&quot;None&quot;</span>], target<span class="sc">==</span><span class="st">&quot;None&quot;</span>, <span class="at">threshold=</span><span class="fl">0.40</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.9130435</span></span></code></pre></div>
<p>Model performance in precision can be similar obtained with micro or
macro averaging method.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>mic_p_s <span class="ot">=</span> <span class="fu">multiclass_precision</span>(preds1, target, <span class="at">average =</span> <span class="st">&quot;micro&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>mac_p_s <span class="ot">=</span> <span class="fu">multiclass_precision</span>(preds1, target, <span class="at">average =</span> <span class="st">&quot;macro&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>mic_p_r <span class="ot">=</span> <span class="fu">multiclass_precision</span>(preds2, target, <span class="at">average =</span> <span class="st">&quot;micro&quot;</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>mac_p_r <span class="ot">=</span> <span class="fu">multiclass_precision</span>(preds2, target, <span class="at">average =</span> <span class="st">&quot;macro&quot;</span>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">model1 =</span> <span class="fu">c</span>(mic_p_s, mac_p_s), <span class="at">model2 =</span> <span class="fu">c</span>(mic_p_r, mac_p_r), <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;Micro Average&quot;</span>, <span class="st">&quot;Macro Average&quot;</span>))</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt;                  model1    model2</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; Micro Average 0.8680162 0.8753036</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; Macro Average 0.8383710 0.8998470</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
